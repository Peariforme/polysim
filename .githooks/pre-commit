#!/usr/bin/env bash
# Pre-commit hook: reject commits with formatting issues or clippy warnings.
set -euo pipefail

echo "▶ cargo fmt --check"
if ! cargo fmt --all -- --check; then
    echo ""
    echo "✗ Formatting check failed."
    echo "  Run 'cargo fmt --all', re-stage your changes, then commit again."
    exit 1
fi

echo "▶ cargo clippy"
if ! cargo clippy --all-targets --all-features -- -D warnings 2>&1; then
    echo ""
    echo "✗ Clippy check failed."
    echo "  Fix the warnings above, re-stage your changes, then commit again."
    exit 1
fi

echo "✓ Pre-commit checks passed."
